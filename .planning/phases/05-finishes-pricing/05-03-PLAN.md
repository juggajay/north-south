---
phase: 05-finishes-pricing
plan: 03
type: execute
wave: 3
depends_on: ["05-02"]
files_modified:
  - src/components/wizard/StepFinishes.tsx
  - src/components/wizard/StepReview.tsx
  - src/components/wizard/MaterialPicker.tsx
  - src/components/wizard/WizardShell.tsx
autonomous: true

must_haves:
  truths:
    - "Step 3 shows real prices next to material/hardware options"
    - "Step 4 shows database-driven price breakdown"
    - "Sticky price bar shows live total throughout wizard"
    - "±5% variance disclaimer visible on review"
  artifacts:
    - path: "src/components/wizard/StepReview.tsx"
      provides: "Review screen with real pricing"
      contains: "usePricing"
    - path: "src/components/wizard/WizardShell.tsx"
      provides: "Wizard with sticky price bar"
      contains: "PriceStickyBar"
  key_links:
    - from: "src/components/wizard/StepReview.tsx"
      to: "src/hooks/usePricing.ts"
      via: "hook import"
      pattern: "import.*usePricing"
    - from: "src/components/wizard/StepReview.tsx"
      to: "src/components/pricing/PriceBreakdown.tsx"
      via: "component import"
      pattern: "import.*PriceBreakdown"
    - from: "src/components/wizard/WizardShell.tsx"
      to: "src/components/pricing/PriceStickyBar.tsx"
      via: "component import"
      pattern: "import.*PriceStickyBar"
---

<objective>
Wire pricing components to the wizard UI, replacing placeholder pricing with real database-driven values.

Purpose: Replace the hardcoded $5000 + $800/module placeholder pricing in StepReview with the usePricing hook. Add PriceStickyBar to the wizard shell so users see live totals. Enhance MaterialPicker to show prices next to options.

Output: Fully integrated pricing throughout the 4-step wizard.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-finishes-pricing/05-RESEARCH.md
@.planning/phases/05-finishes-pricing/05-02-SUMMARY.md

@src/components/wizard/StepReview.tsx
@src/components/wizard/StepFinishes.tsx
@src/components/wizard/MaterialPicker.tsx
@src/components/wizard/WizardShell.tsx
@src/hooks/usePricing.ts
@src/components/pricing/PriceBreakdown.tsx
@src/components/pricing/PriceStickyBar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update StepReview with real pricing</name>
  <files>src/components/wizard/StepReview.tsx</files>
  <action>
Replace the placeholder pricing calculation with the PriceBreakdown component and usePricing hook.

Changes to make:
1. Remove the hardcoded pricing calculation:
   - Remove: `const moduleCount = slots.size`
   - Remove: `const basePrice = 5000`
   - Remove: `const modulePrice = moduleCount * 800`
   - Remove: `const estimatedTotal = basePrice + modulePrice`

2. Import and use PriceBreakdown:
   ```typescript
   import { PriceBreakdown } from '@/components/pricing/PriceBreakdown'
   ```

3. Replace the manual price breakdown section with:
   ```typescript
   <PriceBreakdown />
   ```

4. Update the quote submission placeholder text to remove the "Phase 06" reference - just say "Submit for Quote" will be enabled soon.

5. Keep the configuration summary sections (dimensions, modules, finishes) as they are - they provide valuable context.

The component should now:
- Show dimensions summary (unchanged)
- Show modules summary (unchanged)
- Show finishes summary (unchanged)
- Show PriceBreakdown component (new - replaces hardcoded pricing)
- Show submission placeholder (unchanged text update)
  </action>
  <verify>
Run: `npx tsc --noEmit` - no TypeScript errors
Grep for hardcoded values: `grep -n "5000\|800" src/components/wizard/StepReview.tsx` should return nothing
Grep for PriceBreakdown import: `grep -n "PriceBreakdown" src/components/wizard/StepReview.tsx` should find import
  </verify>
  <done>StepReview uses PriceBreakdown component, no hardcoded pricing, variance disclaimer visible.</done>
</task>

<task type="auto">
  <name>Task 2: Enhance MaterialPicker with prices</name>
  <files>src/components/wizard/MaterialPicker.tsx</files>
  <action>
Add price display next to each option in the MaterialPicker tabs.

Changes to make:

1. Import usePricing hook:
   ```typescript
   import { usePricing } from '@/hooks/usePricing'
   ```

2. In MaterialSwatches component, add price below each swatch:
   - Get formatPrice from usePricing
   - Show price in small text below/on swatch: e.g., "$89.00"
   - Materials already have pricePerUnit from Convex query

Update MaterialSwatches to show price:
```typescript
function MaterialSwatches({ materials, selected, onSelect }: MaterialSwatchesProps) {
  const { formatPrice } = usePricing()
  // ... existing grouping code ...

  // In the button, add price display:
  <button ...>
    {/* existing swatch content */}
    <span className="text-xs text-zinc-600 mt-1 block">
      {formatPrice(mat.pricePerUnit)}
    </span>
  </button>
```

3. In HardwareOptions component, add price with variance:
   - Show price and ±5% indicator
   - Hardware has pricePerUnit and priceVariance from Convex

Update HardwareOptions:
```typescript
function HardwareOptions({ hardware, selected, onSelect }: HardwareOptionsProps) {
  const { formatPrice } = usePricing()
  // ... existing code ...

  // In the button, add price:
  <p className="text-sm text-zinc-700">
    {formatPrice(item.pricePerUnit)}
    {item.priceVariance && (
      <span className="text-xs text-zinc-500 ml-1">±{item.priceVariance}%</span>
    )}
  </p>
```

4. In DoorProfiles component, add price per door:
   - Show "per door" label for clarity
   - Profiles have pricePerDoor from Convex

Update DoorProfiles:
```typescript
function DoorProfiles({ profiles, selected, onSelect }: DoorProfilesProps) {
  const { formatPrice } = usePricing()
  // ... existing code ...

  // In the button, add price:
  <p className="text-sm text-zinc-700">
    {profile.pricePerDoor === 0
      ? 'Included'
      : `${formatPrice(profile.pricePerDoor)}/door`
    }
  </p>
```

Note: formatPrice expects cents, and after Plan 01 the database contains cents.
  </action>
  <verify>
Run: `npx tsc --noEmit` - no TypeScript errors
Visual check that prices appear (will verify in Plan 04)
Grep for usePricing: `grep -n "usePricing" src/components/wizard/MaterialPicker.tsx` should find import
  </verify>
  <done>MaterialPicker shows prices next to all options (material swatches, hardware, door profiles).</done>
</task>

<task type="auto">
  <name>Task 3: Add PriceStickyBar to WizardShell</name>
  <files>src/components/wizard/WizardShell.tsx</files>
  <action>
Add the PriceStickyBar component to the WizardShell so users see live pricing throughout configuration.

1. Import PriceStickyBar:
   ```typescript
   import { PriceStickyBar } from '@/components/pricing/PriceStickyBar'
   ```

2. Add to the shell layout, positioned at bottom.

The WizardShell structure is typically:
- Header (step indicator)
- Content area (step content)
- Navigation (Next/Back buttons)

Add PriceStickyBar above the navigation or as a separate sticky element.

If WizardShell uses a flex column layout:
```tsx
<div className="flex flex-col min-h-full">
  <StepIndicator ... />
  <div className="flex-1 overflow-auto pb-32">
    {/* step content */}
  </div>
  <PriceStickyBar />
  <StepNavigation ... />
</div>
```

If it uses different layout, adapt accordingly. The key is:
- PriceStickyBar should be sticky at bottom
- It should not overlap with navigation buttons
- Add sufficient padding to content area to prevent overlap

Note: The PriceStickyBar already has `sticky bottom-0` styling, so it will stick to the bottom of its container.
  </action>
  <verify>
Run: `npx tsc --noEmit` - no TypeScript errors
Grep for PriceStickyBar: `grep -n "PriceStickyBar" src/components/wizard/WizardShell.tsx` should find import
  </verify>
  <done>WizardShell includes PriceStickyBar, showing live total throughout all wizard steps.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. StepReview uses PriceBreakdown (no hardcoded prices)
3. MaterialPicker shows prices on all tabs
4. WizardShell includes PriceStickyBar
5. No remaining references to placeholder $5000 or $800 values
</verification>

<success_criteria>
- [ ] StepReview imports and uses PriceBreakdown component
- [ ] No hardcoded pricing remains in StepReview
- [ ] MaterialPicker shows prices next to materials
- [ ] MaterialPicker shows prices with ±5% on hardware
- [ ] MaterialPicker shows price/door on door profiles
- [ ] WizardShell includes PriceStickyBar
- [ ] TypeScript compiles successfully
</success_criteria>

<output>
After completion, create `.planning/phases/05-finishes-pricing/05-03-SUMMARY.md`
</output>
