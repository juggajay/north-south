---
phase: 07-customer-portal-notifications
plan: 04
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - src/app/panel/[qrCode]/page.tsx
  - src/components/portal/PanelCard.tsx
autonomous: true

must_haves:
  truths:
    - "QR scan shows panel info without login"
    - "Panel card shows name, dimensions, material, finish"
    - "Page is minimal with product card style"
    - "Installers can access without app account"
  artifacts:
    - path: "src/app/panel/[qrCode]/page.tsx"
      provides: "Public QR lookup route"
      min_lines: 30
    - path: "src/components/portal/PanelCard.tsx"
      provides: "Panel info display card"
      min_lines: 40
  key_links:
    - from: "src/app/panel/[qrCode]/page.tsx"
      to: "convex/panels.ts"
      via: "useQuery for panel lookup"
      pattern: "useQuery.*api\\.panels\\.lookupByQrCode"
---

<objective>
Create public QR panel lookup page that works without authentication. Installers and family members can scan panel QR codes to see basic panel information.

Purpose: Make installation easier by providing panel info to anyone with the QR code. No login friction for helpers.

Output: Public /panel/[qrCode] route with PanelCard component showing panel details.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-customer-portal-notifications/07-CONTEXT.md
@.planning/phases/07-customer-portal-notifications/07-RESEARCH.md
@convex/panels.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PanelCard component</name>
  <files>
    src/components/portal/PanelCard.tsx
  </files>
  <action>
    Create friendly panel info card per CONTEXT.md "product card style":

    **Props interface:**
    ```typescript
    interface PanelCardProps {
      panelName: string;
      dimensions: {
        width: number;
        height: number;
        depth: number;
      };
      material: string;
      finish: string;
    }
    ```

    **Layout:**
    - Card container: max-w-sm, mx-auto, bg-white, rounded-2xl, shadow-lg, overflow-hidden
    - Material swatch placeholder at top (colored div based on material type)
    - Content section with padding:
      - Panel name (text-xl font-bold)
      - Dimensions: "W x H x D mm" format (text-zinc-600)
      - Material name (text-lg)
      - Finish name (text-zinc-500)

    **Material swatch colors (placeholder - actual swatches come from DB):**
    - Use first letter of material to pick bg color
    - Or gradient based on material family (oak -> amber, white -> zinc, etc.)

    **Styling per CONTEXT.md:**
    - Minimal page: just the card, centered
    - No chat/support links per CONTEXT.md
    - Friendly, approachable design
    - Mobile-optimized (will be viewed on phones scanning QR)

    **Empty/Not Found state:**
    - Different component or conditional render
    - Show "Panel not found" with explanation
    - "This QR code may be invalid or the order hasn't been processed yet"
  </action>
  <verify>
    - PanelCard compiles without TypeScript errors
    - Card renders with all 4 fields (name, dimensions, material, finish)
    - Dimensions formatted correctly (mm units)
    - Material swatch placeholder displays
    - Mobile-friendly layout
  </verify>
  <done>
    PanelCard component complete. Displays panel info in friendly card format suitable for installers viewing on mobile.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create public QR lookup page</name>
  <files>
    src/app/panel/[qrCode]/page.tsx
  </files>
  <action>
    Create public (no auth) page for QR code lookups:

    **CRITICAL per CONTEXT.md:** This page must be PUBLIC. Do NOT add:
    - useConvexAuth checks
    - Redirect to login
    - Authenticated component wrapper
    - Any auth requirement

    **Page structure:**
    ```typescript
    "use client";

    import { useQuery } from "convex/react";
    import { api } from "../../../../convex/_generated/api";
    import { PanelCard } from "@/components/portal/PanelCard";

    export default function PanelLookupPage({ params }: { params: { qrCode: string } }) {
      // Decode QR code in case it's URL-encoded
      const qrCode = decodeURIComponent(params.qrCode);

      // Query panel data - no auth check
      const panel = useQuery(api.panels.lookupByQrCode, { qrCode });

      // Loading state
      if (panel === undefined) {
        return <LoadingSkeleton />;
      }

      // Not found state
      if (panel === null) {
        return <NotFoundState qrCode={qrCode} />;
      }

      // Success - show panel card
      return (
        <div className="min-h-screen bg-zinc-50 flex items-center justify-center p-4">
          <PanelCard {...panel} />
        </div>
      );
    }
    ```

    **Loading state:**
    - Centered skeleton card matching PanelCard dimensions
    - Animate-pulse for loading feedback

    **Not found state:**
    - Centered card with warning icon
    - "Panel Not Found" heading
    - "This QR code ({qrCode}) doesn't match any panel in our system."
    - "If you just received your order, it may take a few hours for panels to be registered."
    - Do NOT link to chat/support per CONTEXT.md

    **North South branding:**
    - Small logo or text at bottom: "North South Carpentry"
    - Subtle, doesn't distract from panel info

    **SEO/Meta:**
    - Page title: "Panel Info - North South Carpentry"
    - Description for meta (optional)
  </action>
  <verify>
    - Page accessible at /panel/test-qr-code without login
    - Invalid QR shows not found message
    - Loading state displays during query
    - No auth redirect or login requirement
    - Mobile-friendly centered layout
    - North South branding visible
  </verify>
  <done>
    Public QR lookup page complete. Anyone can scan a panel QR code and see panel info without needing an account.
  </done>
</task>

</tasks>

<verification>
QR lookup verification:
1. Open /panel/test-invalid-code while logged out - should show not found (no redirect to login)
2. Open /panel/test-invalid-code while logged in - same result
3. Verify loading skeleton displays briefly
4. Verify not found message is helpful
5. Verify page is mobile-responsive
6. Test with actual panel QR code once created in Convex dashboard
</verification>

<success_criteria>
- /panel/[qrCode] route is PUBLIC (no auth required)
- Valid QR codes show PanelCard with: name, dimensions, material, finish
- Invalid QR codes show helpful not found message
- Page is minimal per CONTEXT.md (no chat links, just panel info)
- Mobile-optimized layout (centered, readable on phones)
- North South branding present but subtle
</success_criteria>

<output>
After completion, create `.planning/phases/07-customer-portal-notifications/07-04-SUMMARY.md`
</output>
